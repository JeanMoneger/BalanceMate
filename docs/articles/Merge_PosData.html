<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Merge and Structure postural data • BalanceMate</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Merge and Structure postural data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BalanceMate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Butterworth_it.html">Filtering Postural Data Using a Butterworth Filter</a></li>
    <li><a class="dropdown-item" href="../articles/Compute_Postural_Indicators.html">Compute Postural Indicators</a></li>
    <li><a class="dropdown-item" href="../articles/CoPX_ComputeR.html">Compute CoP X</a></li>
    <li><a class="dropdown-item" href="../articles/CoPY_ComputeR.html">Compute CoP-Y</a></li>
    <li><a class="dropdown-item" href="../articles/EllipseArea.html">Compute X% Confidence Ellipse Area</a></li>
    <li><a class="dropdown-item" href="../articles/Epoch_SliceR.html">Synthetise your data into time-bins</a></li>
    <li><a class="dropdown-item" href="../articles/Mean_CoP_ComputeR.html">Compute Mean CoP displacements</a></li>
    <li><a class="dropdown-item" href="../articles/Merge_PosData.html">Merge and Structure postural data</a></li>
    <li><a class="dropdown-item" href="../articles/SD_CoP_ComputeR.html">Compute Standard deviations of CoP displacements</a></li>
    <li><a class="dropdown-item" href="../articles/SpaghettEllipse.html">Visualise Stabilogram and Confidence Ellipse</a></li>
    <li><a class="dropdown-item" href="../articles/SPL_ComputeR.html">Compute Sway Path Length</a></li>
    <li><a class="dropdown-item" href="../articles/Time_StampeR.html">Time_StampeR</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JeanMoneger/BalanceMate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Merge and Structure postural data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JeanMoneger/BalanceMate/blob/HEAD/vignettes/Merge_PosData.Rmd" class="external-link"><code>vignettes/Merge_PosData.Rmd</code></a></small>
      <div class="d-none name"><code>Merge_PosData.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jeanmoneger.github.io/BalanceMate">BalanceMate</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h2>
<p>The typical output of postural software such as
<strong>NetForce</strong> only include minimal data: the raw moments and
forces with un-named columns:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Postural_DataA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Postural_DataA</span><span class="op">)</span></span>
<span><span class="co">#&gt;        V1      V2       V3      V4      V5       V6</span></span>
<span><span class="co">#&gt; 1 7.24049 7.22547 790.0556 5.47499 7.68121 -0.16553</span></span>
<span><span class="co">#&gt; 2 7.46415 7.30759 789.6346 5.41001 7.61477 -0.14419</span></span>
<span><span class="co">#&gt; 3 7.80475 7.35250 789.3054 5.34504 7.54834 -0.12477</span></span>
<span><span class="co">#&gt; 4 7.60925 7.46016 789.3280 5.34504 7.54834 -0.16260</span></span>
<span><span class="co">#&gt; 5 7.49666 6.98660 788.6198 5.34434 7.41616 -0.02562</span></span>
<span><span class="co">#&gt; 6 7.42719 6.95055 788.2588 5.27937 7.34973 -0.07609</span></span></code></pre></div>
<p>In addition, all data files are issued as separate files.</p>
<p>Researchers might want 1) merge each data files together (and label
them in an additional column), 2) label the unlabeled columns, 3)
compute more useful variables such as CoP-X and CoP-Y, 4) add a time
variable that will track the passage of time with each data points.</p>
<p>The <code>Merge_PosData</code> command does just that. It is a great
tool to manage and structure postural data. In addition, it also allows
you to automatically save the resulting file in your directory (default
is to not save the data).</p>
</div>
<div class="section level2">
<h2 id="example-usage">Example usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h2>
<p>You collected data from 6 participants who passively viewed pictures
with a sample rate of 100Hz. Now you have 6 files with 10000 rows stored
in a folder on your computer. Upon opening a file, you realise there
isn’t much information in it.</p>
<p>You first want to identify the path to your folder. In this example,
the files are stored as Rdata in the “data” folder in the package
“BalanceMate”; but your path could be something like
“User/Desktop/PostureData”.</p>
<p><em>Note: the files are stored as Rdata to reduce the size of the
package – however the command only accepts txt files, hence it is
required to first convert Rdata to text files before running the
examples</em></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Locate the installed extdata/ folder (contains only .RData now)</span></span>
<span><span class="va">path_extdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"BalanceMate"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Find all .RData (case‐insensitive)</span></span>
<span><span class="va">rdata_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span>
<span>  <span class="va">path_extdata</span>,</span>
<span>  pattern    <span class="op">=</span> <span class="st">"\\.[Rr][Dd]ata$"</span>,</span>
<span>  full.names <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Convert each .RData to a .txt in a temp directory</span></span>
<span><span class="va">tmpdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">rdata_files</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span>  <span class="co"># e.g. loads object “Postural_DataA” into your session</span></span>
<span>  <span class="va">nm</span> <span class="op">&lt;-</span> <span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/fileutils.html" class="external-link">file_path_sans_ext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">nm</span><span class="op">)</span>,</span>
<span>    file      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tmpdir</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">nm</span>, <span class="st">".txt"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    sep       <span class="op">=</span> <span class="st">","</span>,</span>
<span>    row.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    col.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    quote     <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="co"># 4. Merge from the tempdir</span></span>
<span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Merge_PosData.html">Merge_PosData</a></span><span class="op">(</span></span>
<span>  directory_path <span class="op">=</span> <span class="va">tmpdir</span>,              </span>
<span>  SampleRate     <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  SessionDuration<span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Data</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Fx      Fy       Fz      Mx      My       Mz Time          file_name</span></span>
<span><span class="co">#&gt; 1 7.24049 7.22547 790.0556 5.47499 7.68121 -0.16553 0.01 Postural_DataA.txt</span></span>
<span><span class="co">#&gt; 2 7.46415 7.30759 789.6346 5.41001 7.61477 -0.14419 0.02 Postural_DataA.txt</span></span>
<span><span class="co">#&gt; 3 7.80475 7.35250 789.3054 5.34504 7.54834 -0.12477 0.03 Postural_DataA.txt</span></span>
<span><span class="co">#&gt; 4 7.60925 7.46016 789.3280 5.34504 7.54834 -0.16260 0.04 Postural_DataA.txt</span></span>
<span><span class="co">#&gt; 5 7.49666 6.98660 788.6198 5.34434 7.41616 -0.02562 0.05 Postural_DataA.txt</span></span>
<span><span class="co">#&gt; 6 7.42719 6.95055 788.2588 5.27937 7.34973 -0.07609 0.06 Postural_DataA.txt</span></span>
<span><span class="co">#&gt;        CoP_X     CoP_Y</span></span>
<span><span class="co">#&gt; 1 -0.9722367 0.6929880</span></span>
<span><span class="co">#&gt; 2 -0.9643410 0.6851283</span></span>
<span><span class="co">#&gt; 3 -0.9563269 0.6771827</span></span>
<span><span class="co">#&gt; 4 -0.9562995 0.6771634</span></span>
<span><span class="co">#&gt; 5 -0.9403974 0.6776827</span></span>
<span><span class="co">#&gt; 6 -0.9324006 0.6697508</span></span></code></pre></div>
<p>Your data file is now more structured. You could also want to save
your datafile in the same directory by adding the argument
<code>write_csv = T</code>.</p>
<p>Moreover, it is notable that the <code>Merge_PosData</code> does not
<em>require</em> the <code>SessionDuration</code> argument: it will
compute the time flow based on the length of the data file(s) and the
sample rate. This is fortunate for researchers who might use sessions of
different lenghts. However, in the cases where researchers use sessions
of similar lengths, it is recommended to use the
<code>SessionDuration</code> argument as it will output an error if the
<em>expected duration</em> (indicated in <code>SessionDuration</code>)
does not match the <em>actual duration</em> (identified through the
length of the data file and sampling rate). This can be very useful and
alert you that you have the structure of your file(s) wrong.</p>
</div>
<div class="section level2">
<h2 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<p>The <a href="https://jeanmoneger.com/book/managing-1" class="external-link">Managing
section of the BalanceMate guide book</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jean Monéger.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
